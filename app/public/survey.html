<!DOCTYPE html>
<html>
<head>
    <meta charset = "UTF-8">
    <title>Friend Finder Survey</title>
    <!-- Linking Bootstrap CDN -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery.js"></script>
</head>
<body>

  	<div class="container">

	  	<h1>Welcome to the Survey!</h1>

	  	<h2>About You</h2>

			<form>
			    <div class="form-group">
			    	<label for="name">Name:</label>
			    	<input type="text" class="form-control" id="name">
			    </div>
			    <div class="form-group">
			    	<label for="photo">Link to your photo:</label>
			    	<input type="text" class="form-control" id="photo">
			    </div>
			</form>

		<h2>Questions</h2>

		<h3>Question 1</h3>

			<p>I am an extrovert and I love to be around people at all times.</p>

			<form>
				<input type="radio" name="answer" value="1">1 (Strongly Disagree)<br>
				<input type="radio" name="answer" value="2">2<br>
				<input type="radio" name="answer" value="3">3<br>
				<input type="radio" name="answer" value="4">4<br>
				<input type="radio" name="answer" value="5">5 (Strongly Agree)
			</form>

		<h3>Question 2</h3>

			<p>Craft beer rules and Anheuser-Busch sucks.</p>

			<form>
				<input type="radio" name="answer" value="1">1 (Strongly Disagree)<br>
				<input type="radio" name="answer" value="2">2<br>
				<input type="radio" name="answer" value="3">3<br>
				<input type="radio" name="answer" value="4">4<br>
				<input type="radio" name="answer" value="5">5 (Strongly Agree)
			</form>

		<h3>Question 3</h3>

			<p>Kings of Leon were great until they got big.</p>

			<form>
				<input type="radio" name="answer" value="1">1 (Strongly Disagree)<br>
				<input type="radio" name="answer" value="2">2<br>
				<input type="radio" name="answer" value="3">3<br>
				<input type="radio" name="answer" value="4">4<br>
				<input type="radio" name="answer" value="5">5 (Strongly Agree)
			</form>

		<h3>Question 4</h3>

			<p>Being well dressed is always important.</p>

			<form>
				<input type="radio" name="answer" value="1">1 (Strongly Disagree)<br>
				<input type="radio" name="answer" value="2">2<br>
				<input type="radio" name="answer" value="3">3<br>
				<input type="radio" name="answer" value="4">4<br>
				<input type="radio" name="answer" value="5">5 (Strongly Agree)
			</form>

		<h3>Question 5</h3>

			<p>Life is all about the little things.</p>

			<form>
				<input type="radio" name="answer" value="1">1 (Strongly Disagree)<br>
				<input type="radio" name="answer" value="2">2<br>
				<input type="radio" name="answer" value="3">3<br>
				<input type="radio" name="answer" value="4">4<br>
				<input type="radio" name="answer" value="5">5 (Strongly Agree)
			</form>

		<h3>Question 6</h3>

			<p>Stars Wars is the greatest story ever told.</p>

			<form>
				<input type="radio" name="answer" value="1">1 (Strongly Disagree)<br>
				<input type="radio" name="answer" value="2">2<br>
				<input type="radio" name="answer" value="3">3<br>
				<input type="radio" name="answer" value="4">4<br>
				<input type="radio" name="answer" value="5">5 (Strongly Agree)
			</form>

		<h3>Question 7</h3>

			<p>Success is all about money and social status.</p>

			<form>
				<input type="radio" name="answer" value="1">1 (Strongly Disagree)<br>
				<input type="radio" name="answer" value="2">2<br>
				<input type="radio" name="answer" value="3">3<br>
				<input type="radio" name="answer" value="4">4<br>
				<input type="radio" name="answer" value="5">5 (Strongly Agree)
			</form>

		<h3>Question 8</h3>

			<p>Honesty is the best quality in life.</p>

			<form>
				<input type="radio" name="answer" value="1">1 (Strongly Disagree)<br>
				<input type="radio" name="answer" value="2">2<br>
				<input type="radio" name="answer" value="3">3<br>
				<input type="radio" name="answer" value="4">4<br>
				<input type="radio" name="answer" value="5">5 (Strongly Agree)
			</form>

		<h3>Question 9</h3>

			<p>I definitely want to have children someday.</p>

			<form>
				<input type="radio" name="answer" value="1">1 (Strongly Disagree)<br>
				<input type="radio" name="answer" value="2">2<br>
				<input type="radio" name="answer" value="3">3<br>
				<input type="radio" name="answer" value="4">4<br>
				<input type="radio" name="answer" value="5">5 (Strongly Agree)
			</form>

		<h3>Question 10</h3>

			<p>I always wanted get out of my hometown.<p>

			<form>
				<input type="radio" name="answer" value="1">1 (Strongly Disagree)<br>
				<input type="radio" name="answer" value="2">2<br>
				<input type="radio" name="answer" value="3">3<br>
				<input type="radio" name="answer" value="4">4<br>
				<input type="radio" name="answer" value="5">5 (Strongly Agree)
			</form>

		<button id="submit" type="submit" class="btn btn-large">Submit</button>

		<div id="bs-example-navbar-collapse-1" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-left">
				<li><a href="/api/friends">API Friends List</a></li>
				<li><a href="https://github.com/ppreziotti/friend-finder">GitHub Repo</a></li>
			</ul>
		</div>

		<!-- Modal for displaying friend match (default set to hidden through CSS)-->
		<div id="myModal" class="modal">

			<!-- Modal content -->
			<div class="modal-content">
				<span class="close">&times;</span>
				<p id="modalPar">Some text in the Modal..</p>
				<img id="matchImg">
			</div>

		</div>

	</div>

	<style>

	.modal {
	    display: none; /* Hidden by default */
	    position: fixed; /* Stay in place */
	    z-index: 1; /* Sit on top */
	    left: 0;
	    top: 0;
	    width: 100%; /* Full width */
	    height: 100%; /* Full height */
	    overflow: auto; /* Enable scroll if needed */
	    background-color: rgb(0,0,0); /* Fallback color */
	    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
	}

	/* Modal Content/Box */
	.modal-content {
	    background-color: #fefefe;
	    margin: 15% auto; /* 15% from the top and centered */
	    padding: 20px;
	    border: 1px solid #888;
	    width: 80%; /* Could be more or less, depending on screen size */
	}

	/* The Close Button */
	.close {
	    color: #aaa;
	    float: right;
	    font-size: 28px;
	    font-weight: bold;
	}

	.close:hover,
	.close:focus {
	    color: black;
	    text-decoration: none;
	    cursor: pointer;
	}

	</style>

	<script type="text/javascript">

		$("#submit").on("click", function() {
			var name = $("#name").value;
			console.log(name);
			var answers = document.getElementsByName("answer");
			var userScores = [];
			for (var i = 0; i < answers.length; i++) {
				if (answers[i].checked) {
					userScores.push(answers[i].value);
				}
			}
			console.log(userScores);

			var currentURL = window.location.origin;
			$.ajax({
				url: currentURL + "/api/friends", 
				method: "GET"
			}).done(function(data) {
				console.log("URL: " + currentURL + "/api/friends");
				var scoreDifArray = [];
				for (var i = 0; i < data.length; i++) {
					var scoreDif = 0;
					for (var j = 0; j < data[i].scores.length; j++) {
						scoreDif += Math.abs(parseInt(userScores[j]) - parseInt(data[i].scores[j]));
					}
					console.log(scoreDif);
					scoreDifArray.push(scoreDif);
				}
				console.log(scoreDifArray);
				var minScoreDif = Math.min.apply(null, scoreDifArray);
				console.log(minScoreDif);
				var matchIndex = scoreDifArray.indexOf(minScoreDif);
				var match = data[matchIndex];
				console.log(match.name);
				showModal();

				function showModal() {
					var modal = document.getElementById('myModal');
					var span = document.getElementsByClassName("close")[0];
					$("#modalPar").html("You matched with " + match.name + "!");
					$("#matchImg").attr("src", match.photo);
					modal.style.display = "block";	
				}
			});
		});
		
	</script>

</body>
</html>